<!DOCTYPE html5>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>In pain,In dream</title>
</head>

<body id="body" style="margin: 0;padding: 0;background-color: black;" onclick="fullScreenModel()"
    onmousemove="handleShowMouse()" class="w-full h-full">
    <div id="commit" class="text-white absolute left-50 top-50 transeXY-50 text-center transition">
        <div>请点击屏幕全屏观看</div>
        <div>Please click on the screen to watch in full screen</div>
    </div>
    <div class="w-full h-full display-none" id="container">
        <div style="width: 100%;height: 100%;" class="mb-1">
            <video id="player" class="inline-block">
                <source src="https://drive.google.com/uc?export=preview&id=17U0YWk0UNRf5bK4LVrFRl_t9ZP9B6IMj"
                    type="video/mp4">
            </video>
            <div id="progressContainer" class="w-full h-5px  flex justify-center hidden">
                <div id="progress" class="bg-white h-5px w-full opcity-8" style="transform: translateY(0px);"
                    onresize="handleOnresize"></div>
            </div>
            <div id="btn" class="bg-black text-gray w-full flex justify-space-around pt-10  absolute b-0 hidden"
                style="transform: translateY(-20px);">
                <div id="leftBtn" class="h-50 text-center flex flex-col cursor-pointer"
                    onmouseover="handleMouseover('leftBtn')" onmouseleave="handleMouseleave('leftBtn')"
                    onclick="handleNext('leftBtn')">
                    <div class="inline p-1" id="leftBtnChinese"></div>
                    <div class="inline p-1" id="leftBtnEnglish"></div>
                    <div id="linear" class="h-4"></div>
                </div>
                <div id="rightBtn" class="h-50 text-center flex flex-col cursor-pointer "
                    onmouseover="handleMouseover('rightBtn')" onmouseleave="handleMouseleave('rightBtn')"
                    onclick="handleNext('rightBtn')">
                    <div class="inline p-1" id="rightBtnChinese"></div>
                    <div class="inline p-1" id="rightBtnEnglish"></div>
                    <div id="linear" class="h-4"></div>
                </div>
            </div>
        </div>
    </div>
</body>
<script>

    let currentPlayIndex = 0
    let timer = null//进度条定时器
    const player = document.getElementById("player");
    const leftBtnChinese = document.getElementById('leftBtnChinese')
    const leftBtnEnglish = document.getElementById('leftBtnEnglish')
    const rightBtnChinese = document.getElementById('rightBtnChinese')
    const rightBtnEnglish = document.getElementById('rightBtnEnglish')
    //进度条容器
    const progressContainer = document.getElementById('progressContainer')


    const progress = document.getElementById('progress')
    const progressCss = window.getComputedStyle(progress)
    const progressWidth = parseInt(progressCss.width)//进度条默认宽度
    const playList = [
        {
            index: 0,
            src: 'https://drive.google.com/uc?export=preview&id=17U0YWk0UNRf5bK4LVrFRl_t9ZP9B6IMj',
            leftBtnName: {
                chinese: '递出纸条',
                english: 'Pass the note'
            },
            rightBtnName: {
                chinese: '不递纸条',
                english: 'Not handing the note'
            },
            leftBtn: 1,
            rightBtn: 2,
        },
        {
            index: 1,
            src: 'https://drive.google.com/uc?export=preview&id=1UAyfYrFS-zqNp0FzrYZUJzOrszqCiKKW',
            next: 3
        },
        {
            index: 2,
            src: 'https://drive.google.com/uc?export=preview&id=10s4mWfiyfQLxpk-vVv6MLj5sm67l23G4',
            next: 3
        },
        {
            index: 3,
            src: 'https://drive.google.com/uc?export=preview&id=13N1Np67_UMK_lgJJo8K6RjhitOqjj88H',
            leftBtnName: {
                chinese: '承认',
                english: 'Admit'
            },
            rightBtnName: {
                chinese: '否认',
                english: 'Deny'
            },
            leftBtn: 4,
            rightBtn: 5,
        }
        ,
        {
            index: 4,
            src: 'https://drive.google.com/uc?export=preview&id=1VlH-MudPXHvoRcvdn_YHJ7obRwdGp3Ue',
            next: 6
        }
        ,
        {
            index: 5,
            src: 'https://drive.google.com/uc?export=preview&id=11fIUJ1Mkuyu4MYOxJZK_JpgZqhB07H3a',
            next: 6
        }
        ,
        {
            index: 6,
            src: 'https://drive.google.com/uc?export=preview&id=16eAFx-_PJMRK0lj8PANbQLs924gDCj9g',
            next: 7
        }
        ,
        {
            index: 7,
            src: 'https://drive.google.com/uc?export=preview&id=1BOXd4r8rE2MJlHn4gvL_oh_tkhhZ_qhd',
            leftBtnName: {
                chinese: '打开门让母亲看见血迹',
                english: 'let mother help'
            },
            rightBtnName: {
                chinese: '独自留在厕所处理血迹',
                english: 'handle it alone'
            },
            leftBtn: 8,
            rightBtn: 9,
        }
        ,
        {
            index: 8,
            src: 'https://drive.google.com/uc?export=preview&id=1mwStk-OnktsQE9jhYtg9whXL_Bb6-IKr',
            next: 10
        }
        ,
        {
            index: 9,
            src: 'https://drive.google.com/uc?export=preview&id=1suMsgIbNcBvMskTUpqMol8K1ChnN6D5f',
            next: 10
        }
        ,
        {
            index: 10,
            src: 'https://drive.google.com/uc?export=preview&id=18oc8b1-g3Q61Z4s2r9eD-gihO72Fumg2',
            leftBtnName: {
                chinese: '提及血迹',
                english: 'Mention of bloodstains'
            },
            rightBtnName: {
                chinese: '递出手机',
                english: 'Give out the phone'
            },
            leftBtn: 11,
            rightBtn: 12,
        }
        ,
        {
            index: 11,
            src: 'https://drive.google.com/uc?export=preview&id=1j2-FsHk5bWDDOnfUbXS4oA3sqSJj8ySu',
            next: 13
        }
        ,
        {
            index: 12,
            src: 'https://drive.google.com/uc?export=preview&id=1Vfl1KqB8_A48hhsKBXOrTdn3ZkkVNbwZ',
            next: 13
        }
        ,
        {
            index: 13,
            src: 'https://drive.google.com/uc?export=preview&id=1cxP1I6BCYoGFz-qYU93WOd_t3_W_-Xfi',
            leftBtnName: {
                chinese: '接受',
                english: 'Accept'
            },
            rightBtnName: {
                chinese: '拒绝',
                english: 'Reject'
            },
            leftBtn: 14,
            rightBtn: 15,
        }
        ,
        {
            index: 14,
            src: 'https://drive.google.com/uc?export=preview&id=1kMJEMx_FKJnzpeS8RtwSdURQD5RFQaYY',
            next: 16
        }
        ,
        {
            index: 15,
            src: 'https://drive.google.com/uc?export=preview&id=1aTsV8PH857Ny7els7fAUADnzt0MpOmQf',
            next: 16
        }
        ,
        {
            index: 16,
            src: 'https://drive.google.com/uc?export=preview&id=14c32NDK_rOWcMOtwD83zP72v8JP6QH97',
            leftBtnName: {
                chinese: '偷听',
                english: 'Eavesdrop'
            },
            rightBtnName: {
                chinese: '偷窥',
                english: 'Peep'
            },
            leftBtn: 17,
            rightBtn: 18,
        }
        ,
        {
            index: 17,
            src: '',
            next: 19
        }
        ,
        {
            index: 18,
            src: 'https://drive.google.com/uc?export=preview&id=1HOvdlxxpi_2nh9EFzZEVMfdgMB7YxXlA',
            next: 19
        }
        ,
        {
            index: 19,
            src: 'https://drive.google.com/uc?export=preview&id=1jfhl1IDyZjWCuB-5nMZ7g4sguCdOgGWq',
            over: true
        }

    ]




    function hideCommit() {
        const commit = document.getElementById('commit');
        const container = document.getElementById('container');
        commit.style.opacity = '0';
        setTimeout(() => {
            container.classList.remove('display-none')
            player.play()
        }, 5500);
    }
    hideCommit()


    //超时隐藏鼠标
    let showMouseTimer = null
    function handleShowMouse() {
        clearTimeout(showMouseTimer)
        const body = document.querySelector('body');
        body.classList.remove('cursornone');
        showMouseTimer = setTimeout(() => {
            body.classList.add('cursornone');
        }, 2000);
    }


    /** 全屏事件 */
    function fullScreenModel() {
        const element = document.getElementById('container');
        /** 不同浏览器下需考虑兼容性问题*/
        if (element.requestFullscreen) {
            element.requestFullscreen();
        } else if (element['msRequestFullscreen']) {
            element['msRequestFullscreen']();
        } else if (element['mozRequestFullScreen']) {
            element['mozRequestFullScreen']();
        } else if (element['webkitRequestFullscreen']) {
            element['webkitRequestFullscreen']();
        }
        this.isFullScreen = true;
    }

    /** 退出全屏事件 */
    function exitFullScreenModel() {
        if (document.exitFullscreen) {
            document.exitFullscreen();
        } else if (document['msExitFullscreen']) {
            document['msExitFullscreen']();
        } else if (document['mozCancelFullScreen']) {
            document['mozCancelFullScreen']();
        } else if (document['webkitExitFullscreen']) {
            document['webkitExitFullscreen']();
        }
        this.isFullScreen = false;
    }




    //监听开始事件
    player.addEventListener("play", () => {
        console.log("开始")
    })




    //进度条变化进入默认事件
    function handleOnresize() {
        const progress = document.getElementById('progress')
        console.log('resize')
    }




    //进度条
    function startProgress() {
        //显示按钮和进度条
        progressContainer.classList.remove('hidden')
        timer = setInterval(() => {
            let progressWidth = parseInt(progressCss.width)
            progress.style.width = progressWidth - 1 + 'px'
            if (progressWidth <= 0) {
                clearInterval(timer)
                handleNext()
            }
        }, 5);

    }

    //关闭进度条
    function closeProgress() {
        clearInterval(timer)
        progress.style.width = progressWidth + 'px'
        progressContainer.classList.add('hidden')
    }

    //选择
    function handleNext(dur) {
        if (playList[currentPlayIndex].over) return
        if (dur == 'leftBtn') {
            player.src = playList[playList[currentPlayIndex].leftBtn].src
            currentPlayIndex = playList[currentPlayIndex].leftBtn
            closeProgress()
        }
        if (dur == 'rightBtn') {
            player.src = playList[playList[currentPlayIndex].rightBtn].src
            currentPlayIndex = playList[currentPlayIndex].rightBtn
            closeProgress()
        }

        if (!dur) {
            let random = parseInt(Math.random() * 10)
            console.log(random)
            if (random > 5) {
                player.src = playList[playList[currentPlayIndex].leftBtn].src
                currentPlayIndex = playList[currentPlayIndex].leftBtn
            } else {
                player.src = playList[playList[currentPlayIndex].rightBtn].src
                currentPlayIndex = playList[currentPlayIndex].rightBtn
            }

            closeProgress()
        }
        closeBtn()
    }

    //显示选项
    function showBtn() {
        const btn = document.getElementById('btn')
        btn.classList.remove('hidden')
        //更改文字
        leftBtnChinese.innerText = playList[currentPlayIndex].leftBtnName.chinese
        leftBtnEnglish.innerText = playList[currentPlayIndex].leftBtnName.english
        rightBtnChinese.innerText = playList[currentPlayIndex].rightBtnName.chinese
        rightBtnEnglish.innerText = playList[currentPlayIndex].rightBtnName.english


    }

    //关闭选项
    function closeBtn() {
        const btn = document.getElementById('btn')
        btn.classList.add('hidden')
        //更改文字
        leftBtnChinese.innerText = ''
        leftBtnEnglish.innerText = ''
        rightBtnChinese.innerText = ''
        rightBtnEnglish.innerText = ''

    }
    //视频播放结束
    player.addEventListener("ended", () => {
        //处理顺序播放
        if (playList[currentPlayIndex].next) {
            player.src = playList[playList[currentPlayIndex].next].src
            currentPlayIndex = playList[currentPlayIndex].next
        } else {
            showBtn()
            startProgress()
        }
    })


    //鼠标进入样式更改
    function handleMouseover(id) {
        const el = document.getElementById(id)
        const linear = el.children[2]
        el.classList.remove('text-gray')
        el.classList.add('text-white')
        linear.className = 'linear'
    }

    //鼠标离开样式恢复
    function handleMouseleave(id) {
        const el = document.getElementById(id)
        const linear = el.children[2]
        el.classList.remove('text-white')
        el.classList.add('text-gray')
        linear.className = 'h-4'
    }


</script>
<style>
    .cursornone {
        cursor: none;
    }

    .transition {
        transition: opacity 5s ease-in-out;
    }

    .bg-black {
        background-color: black;
    }

    .opcity-8 {
        opacity: 0.8;
    }

    .absolute {
        position: absolute;
    }

    .top-50 {
        top: 50%
    }

    .left-50 {
        left: 50%;
    }

    .transeXY-50 {
        transform: translateX(-50%) translateY(-50%);
    }



    .b-0 {
        bottom: 0;
    }

    .h-5px {
        height: 5px;
    }

    .bg-white {
        background-color: white;
    }

    .text-white {
        color: white;
    }

    .text-gray {
        color: rgb(188, 185, 185);
    }

    .inline {
        display: inline;
    }

    .inline-block {
        display: inline-block;
    }

    .h-50 {
        height: 50%;
    }

    .h-4 {
        height: 4px;
    }

    .w-full {
        width: 100%;
    }

    .w-90 {
        width: 90%;
    }

    .h-full {
        height: 100%;
    }

    .flex {
        display: flex;
    }

    .justify-center {

        justify-content: center;
    }

    .justify-space-around {
        justify-content: space-around;
    }


    .align-center {
        align-items: center;
    }

    .flex-col {
        flex-direction: column;
    }

    .flex-row {
        flex-direction: row;
    }

    .text-center {
        text-align: center;
    }

    .cursor-pointer {
        cursor: pointer;
    }

    .p-1 {
        padding: 1px;
    }

    .mb-1 {
        margin-bottom: 1px;
    }

    .pt-10 {
        padding-top: 10px;
    }





    .linear {
        /* width: 50px; */
        height: 1px;
        margin-top: 3px;
        background: linear-gradient(to right, rgb(0, 0, 0), rgb(255, 255, 255), rgb(0, 0, 0));
        background-clip: padding-box, border-box;
        border-bottom: 0px solid transparent;
    }

    .hidden {
        visibility: hidden;
    }

    .display-none {
        display: none;
    }
</style>

</html>